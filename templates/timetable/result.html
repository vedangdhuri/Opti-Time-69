{% extends "base.html" %}
{% block title %}Generated Timetable{% endblock %}

{% block content %}
<div class="card border-0 shadow-sm mb-4">
  <div class="card-body p-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
         <h4 class="fw-bold m-0 text-success d-flex align-items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-check-circle-fill" viewBox="0 0 16 16">
                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
            </svg>
            Generated Schedule
         </h4>
         <a href="{% url 'ortools_app:timetable-input' %}" class="btn btn-outline-primary btn-sm rounded-pill px-3">
             <i class="bi bi-arrow-counterclockwise"></i> Regenerate
         </a>
    </div>

    {% if error %}
      <div class="alert alert-danger rounded-3">{{ error }}</div>
    {% endif %}

    <div class="table-responsive rounded-3 border">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th class="py-3 ps-4">Class</th>
            <th class="py-3">Subject</th>
            <th class="py-3">Teacher</th>
            <th class="py-3">Room</th>
            <th class="py-3">Day</th>
            <th class="py-3 pe-4">Slot</th>
          </tr>
        </thead>
        <tbody>
          {% for row in timetable %}
          <tr>
            <td class="ps-4 fw-bold text-dark">{{ row.class.name }}</td>
            <td class="fw-semibold text-primary">{{ row.subject.name }}</td>
            <td>{{ row.subject.teacher.name }}</td>
            <td>
                <span class="badge bg-light text-dark border">
                    {{ row.room.name }}
                </span>
            </td>
            <td>{{ row.slot.day }}</td>
            <td class="pe-4">
                <span class="badge bg-secondary bg-opacity-10 text-secondary">
                    Slot {{ row.slot.slot }}
                </span>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="6" class="text-center py-5 text-muted">
              <div class="mb-2 opacity-50">
                  <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-calendar-x" viewBox="0 0 16 16">
                    <path d="M6.146 7.146a.5.5 0 0 1 .708 0L8 8.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 9l1.147 1.146a.5.5 0 0 1-.708.708L8 9.707l-1.146 1.147a.5.5 0 0 1-.708-.708L7.293 9 6.146 7.854a.5.5 0 0 1 0-.708z"/>
                    <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                  </svg>
              </div>
              No timetable generated
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

  </div>
</div>
{% endblock %}
